```mermaid
flowchart TD
    ثبت_کاربر["ثبت‌نام کاربر جدید"]
    ورود["ورود به حساب کاربری"]
    انتخاب_نقش["انتخاب نقش: قرض‌دهنده یا قرض‌گیرنده"]
    جستجوی_کتاب["جستجوی کتاب موردنظر"]
    درخواست_امانت["ارسال درخواست امانت"]
    بررسی_درخواست["بررسی درخواست توسط قرض‌دهنده"]
    تایید_امانت["تایید و ثبت امانت"]
    تحویل_کتاب["تحویل کتاب به قرض‌گیرنده"]
    بازگرداندن_کتاب["بازگرداندن کتاب در موعد مقرر"]
    ثبت_بازگشت["ثبت بازگشت کتاب"]
    امتیازدهی["امتیازدهی به طرف مقابل"]

    ثبت_کاربر --> ورود
    ورود --> انتخاب_نقش
    انتخاب_نقش --> جستجوی_کتاب
    جستجوی_کتاب --> درخواست_امانت
    درخواست_امانت --> بررسی_درخواست
    بررسی_درخواست -->|تایید| تایید_امانت
    تایید_امانت --> تحویل_کتاب
    تحویل_کتاب --> بازگرداندن_کتاب
    بازگرداندن_کتاب --> ثبت_بازگشت
    ثبت_بازگشت --> امتیازدهی
